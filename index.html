<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Confuc10 ++ - Advanced Chinese Learning Platform</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Modern HSK Chinese learning app with flashcards, quizzes, and progress tracking">
    <meta name="theme-color" content="#e11d48">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="HSK Learning">

    <!-- Icons -->
    <link rel="icon" type="image/png" href="assets/images/logo_appDM.png">
    <link rel="apple-touch-icon" href="assets/images/logo_appLM.png">

    <!-- Styles -->
    <!-- <link rel="stylesheet" href="assets/css/styles-v2.css?v=10"> -->
    <!-- <link rel="stylesheet" href="assets/css/styles-final.css?v=1"> -->
    <!-- <link rel="stylesheet" href="assets/css/styles-planetscale-v17.css" id="main-stylesheet-old"> -->
    <link rel="stylesheet" href="assets/css/styles-professional.css?v=10" id="main-stylesheet">
    <link rel="stylesheet" href="assets/css/matrix-game-styles.css?v=2">
    <link rel="stylesheet" href="assets/css/leaderboard-styles.css?v=2">
    <link rel="stylesheet" href="assets/css/user-profile-styles.css?v=2">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Noto+Sans+SC:wght@300;400;500;700&display=swap"
        rel="stylesheet" id="fonts-stylesheet">

    <!-- PWA Manifest -->
    <link rel="manifest" href="config/manifest.json">

    <!-- Resource Validation Script -->
    <script>
        // Validate critical resources on load
        window.addEventListener('load', function () {
            console.log('üîç Validating critical resources...');

            // Check if main stylesheet loaded
            const mainStylesheet = document.getElementById('main-stylesheet');
            if (mainStylesheet && !mainStylesheet.sheet) {
                console.warn('‚ö†Ô∏è Main stylesheet failed to load, applying fallback styles');

                // Create fallback styles
                const fallbackCSS = document.createElement('style');
                fallbackCSS.textContent = `
                    body { font-family: 'Segoe UI', system-ui, sans-serif; margin: 0; background: #1a1a1a; color: white; }
                    .app-container { min-height: 100vh; display: flex; flex-direction: column; }
                    .nav-tab.active { background: #3b82f6; color: white; }
                    .flashcard { background: #2a2a2a; border-radius: 12px; padding: 2rem; margin: 2rem auto; }
                `;
                document.head.appendChild(fallbackCSS);
            }

            console.log('[‚úì] Resource validation complete');
        });

        // Error handler for missing resources
        function showResourceError(resource) {
            console.error(`[‚úó] Failed to load: ${resource}`);

            // Create error notification
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 10000;
                background: #ef4444; color: white; padding: 12px 16px;
                border-radius: 8px; font-size: 14px; max-width: 300px;
            `;
            errorDiv.textContent = `Error loading ${resource}. Some features may not work correctly.`;
            document.body.appendChild(errorDiv);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (errorDiv.parentNode) {
                    errorDiv.parentNode.removeChild(errorDiv);
                }
            }, 5000);
        }
    </script>

    <!-- Scripts moved to end of body for proper loading order -->
</head>

<body>
    <!-- Pilares laterales chinos mejorados -->
    <div class="vertical-pillar-left">
        <div class="lantern-top"></div>
        <div class="coin-bottom"></div>
    </div>
    <div class="vertical-pillar-right">
        <div class="lantern-top"></div>
        <div class="coin-bottom"></div>
    </div>

    <!-- Elementos laterales verticales -->
    <div class="vertical-text-left">Â≠îÂ≠êÂ≠¶Èô¢</div>
    <div class="vertical-text-right">‰ΩïÂÆ∏Êúó</div>

    <div class="app-container">
        <header class="app-header">
            <div class="header-container">
                <div class="header-content">
                    <!-- Logo Section -->
                    <div class="header-brand">
                        <img src="assets/images/logo_appDM.png" alt="Confuc10 ++" class="logo">
                        <div class="logo-text">
                            <h1 class="app-title">Confuc10 ++</h1>
                            <p class="app-subtitle">HSK Chinese Learning Platform</p>
                        </div>
                    </div>

                    <!-- Stats Section -->
                    <div class="header-stats">
                        <div class="header-stat">
                            <div class="header-stat-value" id="header-studied">0</div>
                            <div class="header-stat-label" data-i18n="totalStudied">Studied</div>
                        </div>
                        <div class="header-stat">
                            <div class="header-stat-value" id="header-streak">0</div>
                            <div class="header-stat-label" data-i18n="currentStreak">Streak</div>
                        </div>
                        <div class="header-stat">
                            <div class="header-progress">
                                <div class="header-progress-fill" id="header-progress" style="width: 0%"></div>
                            </div>
                            <div class="header-stat-label" data-i18n="progress">Progress</div>
                        </div>
                    </div>

                    <!-- Controls Section -->
                    <div class="header-actions">
                        <div id="auth-container" class="auth-container">
                            <!-- Authentication UI will be inserted here -->
                        </div>

                        <input type="text" id="header-search" placeholder="Search vocabulary..."
                            data-i18n-placeholder="searchPlaceholder">

                        <select id="language-select" class="header-control" title="Language"
                            data-i18n-title="languageSelectorTitle" data-tooltip="Change interface language" data-i18n-tooltip="languageSelectorTooltip">
                            <option value="en">EN</option>
                            <option value="es">ES</option>
                        </select>

                        <!-- Theme Toggle -->
                        <button id="theme-toggle" class="header-control" title="Toggle Theme"
                            data-i18n-title="themeToggleTitle" data-tooltip="Switch between dark and light mode">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                        </button>

                        <select id="voice-select" class="header-control" title="Voice"
                            data-i18n-title="voiceSelectorTitle" data-tooltip="Select voice for pronunciation" data-i18n-tooltip="voiceSelectorTooltip">
                            <option value="auto">Auto</option>
                            <option value="male">Masculino</option>
                            <option value="female">Femenino</option>
                        </select>

                        <button id="audio-toggle" class="header-control" title="Toggle Audio"
                            data-i18n-title="audioToggleTitle" data-tooltip="Toggle pronunciation audio">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-container">
            <div class="nav-tabs">
                <button class="nav-tab" data-tab="home"><span data-i18n="homeTab">Home</span></button>
                <button class="nav-tab active" data-tab="practice"><span
                        data-i18n="practiceTab">Practice</span></button>
                <button class="nav-tab" data-tab="browse"><span data-i18n="browseTab">Browse</span></button>
                <button class="nav-tab" data-tab="quiz"><span data-i18n="quizTab">Quiz</span></button>
                <button class="nav-tab" data-tab="matrix">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" style="margin-right: 6px;">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                    <span data-i18n="matrixTab">Matrix</span>
                </button>
                <button class="nav-tab" data-tab="leaderboard">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" style="margin-right: 6px;">
                        <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                        <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                        <path d="M4 22h16"></path>
                        <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                        <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                        <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                    </svg>
                    <span data-i18n="leaderboard">Leaderboard</span>
                </button>
                <button class="nav-tab" data-tab="stats"><span data-i18n="statsTab">Statistics</span></button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content" id="main-content">
            <div class="content-wrapper">
                <!-- Home Tab -->
                <div id="home" class="tab-panel">
                    <div class="home-hero">
                        <h2 data-i18n="homeWelcomeTitle">Welcome to Confuc10 ++!</h2>
                        <p data-i18n="homeWelcomeSubtitle">The advanced platform to master Mandarin Chinese</p>
                        <div class="welcome-stats">
                            <div class="welcome-stat">
                                <span class="stat-number">5000+</span>
                                <span class="stat-label" data-i18n="homeStatCharacters">Characters</span>
                            </div>
                            <div class="welcome-stat">
                                <span class="stat-number">6</span>
                                <span class="stat-label" data-i18n="homeStatHskLevels">HSK Levels</span>
                            </div>
                            <div class="welcome-stat">
                                <span class="stat-number">4</span>
                                <span class="stat-label" data-i18n="homeStatPracticeModes">Practice Modes</span>
                            </div>
                        </div>
                    </div>
                    <div class="home-cards">
                        <div class="home-card" data-tab-target="practice" role="button" tabindex="0" onclick="window.app && window.app.switchTab('practice')">
                            <div class="home-card-icon chinese-char">ÁªÉ‰π†</div>
                            <div class="home-card-title" data-i18n="homeCardPracticeTitle">Practice</div>
                            <div class="home-card-desc" data-i18n="homeCardPracticeDesc">Flashcards and guided practice</div>
                        </div>
                        <div class="home-card" data-tab-target="browse" role="button" tabindex="0" onclick="window.app && window.app.switchTab('browse')">
                            <div class="home-card-icon chinese-char">ËØçÊ±á</div>
                            <div class="home-card-title" data-i18n="homeCardBrowseTitle">Browse</div>
                            <div class="home-card-desc" data-i18n="homeCardBrowseDesc">Explore vocabulary by level</div>
                        </div>
                        <div class="home-card" data-tab-target="quiz" role="button" tabindex="0" onclick="window.app && window.app.switchTab('quiz')">
                            <div class="home-card-icon chinese-char">ÊµãÈ™å</div>
                            <div class="home-card-title" data-i18n="homeCardQuizTitle">Quiz</div>
                            <div class="home-card-desc" data-i18n="homeCardQuizDesc">Test your knowledge</div>
                        </div>
                        <div class="home-card" data-tab-target="matrix" role="button" tabindex="0" onclick="window.app && window.app.switchTab('matrix')">
                            <div class="home-card-icon chinese-char">Áü©Èòµ</div>
                            <div class="home-card-title" data-i18n="homeCardMatrixTitle">Matrix</div>
                            <div class="home-card-desc" data-i18n="homeCardMatrixDesc">Find characters against the clock</div>
                        </div>
                        <div class="home-card" data-tab-target="stats" role="button" tabindex="0" onclick="window.app && window.app.switchTab('stats')">
                            <div class="home-card-icon chinese-char">ÁªüËÆ°</div>
                            <div class="home-card-title" data-i18n="homeCardStatsTitle">Statistics</div>
                            <div class="home-card-desc" data-i18n="homeCardStatsDesc">Track your progress and streaks</div>
                        </div>
                    </div>
                </div>

                <!-- Practice Tab -->
                <div id="practice" class="tab-panel active">
                    <div class="practice-container">
                        <div class="study-progress">
                            <div class="study-progress-header">
                                <span class="study-progress-title" data-i18n="todayProgress">Today's Progress</span>
                                <span class="study-progress-value" id="today-progress">0 / 20</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="progress-fill" style="width: 0%"></div>
                            </div>
                            <div class="study-streak">
                                <div class="streak-day" data-day="M">M</div>
                                <div class="streak-day" data-day="T">T</div>
                                <div class="streak-day" data-day="W">W</div>
                                <div class="streak-day active" data-day="T">T</div>
                                <div class="streak-day active" data-day="F">F</div>
                                <div class="streak-day active" data-day="S">S</div>
                                <div class="streak-day today" data-day="S">S</div>
                            </div>
                        </div>

                        <div class="level-selector">
                            <label for="level-select" data-i18n="levelLabel">HSK Level</label>
                            <select id="level-select" class="select-input"
                                data-tooltip="Choose your HSK level to start practicing">
                                <option value="" data-i18n="selectLevel">Select level...</option>
                                <option value="1" selected>HSK 1</option>
                                <option value="2">HSK 2</option>
                                <option value="3">HSK 3</option>
                                <option value="4">HSK 4</option>
                                <option value="5">HSK 5</option>
                                <option value="6">HSK 6</option>
                            </select>
                        </div>

                        <!-- Flashcard Display -->
                        <div class="flashcard-area">
                            <div id="flashcard" class="flashcard">
                                <div class="flashcard-inner">
                                    <div class="card-face card-front">
                                        <div class="card-character" id="question-text"></div>
                                        <div class="card-hint" id="hint-text"></div>
                                    </div>
                                    <div class="card-face card-back">
                                        <div class="card-answer" id="answer-text"></div>
                                        <div class="card-details" id="full-info"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Flashcard Controls Removed (replaced by Pinyin Input) -->

                        <!-- Pinyin Input Section -->
                        <div class="pinyin-input-container">
                            <input type="text" id="pinyin-input" class="pinyin-input" data-i18n-placeholder="typePinyin" placeholder="Type Pinyin..."
                                autocomplete="off" autocapitalize="off" spellcheck="false">
                            <div id="feedback-message" class="feedback-message"></div>
                            <button id="check-btn" class="action-btn" style="display: none;" data-i18n="submit">Submit</button>
                            <button id="next-card-next-btn" class="action-btn next-btn-hidden"
                                style="display: none;" data-i18n="next">Next</button>
                        </div>

                        <!-- Hidden legacy buttons (just in case) -->
                        <div class="difficulty-buttons" style="display: none !important;"></div>
                        <div id="simple-buttons" style="display: none !important;"></div>
                    </div>
                </div>

                <!-- Browse Tab -->
                <div id="browse" class="tab-panel">
                    <div class="search-section">
                        <div class="search-container">
                            <input type="text" id="search-input" class="search-input"
                                placeholder="Search by character, pinyin or translation..."
                                data-i18n-placeholder="searchPlaceholder">
                            <select id="browse-level-filter" class="select-input">
                                <option value="all" data-i18n="allLevels">All levels</option>
                                <option value="1">HSK 1</option>
                                <option value="2">HSK 2</option>
                                <option value="3">HSK 3</option>
                                <option value="4">HSK 4</option>
                                <option value="5">HSK 5</option>
                                <option value="6">HSK 6</option>
                            </select>
                        </div>
                    </div>

                    <div class="browse-stats" id="browse-stats"></div>

                    <div class="vocabulary-grid" id="vocabulary-grid">
                        <!-- Vocabulary cards will be populated here -->
                    </div>
                </div>

                <!-- Quiz Tab -->
                <div id="quiz" class="tab-panel">
                    <div class="quiz-setup" id="quiz-setup">
                        <h3 data-i18n="configureQuiz">Configure Quiz</h3>
                        <div class="quiz-options">
                            <div class="control-group">
                                <label for="quiz-level" class="control-label" data-i18n="levelLabel">HSK Level</label>
                                <select id="quiz-level" class="select-input">
                                    <option value="1">HSK 1</option>
                                    <option value="2">HSK 2</option>
                                    <option value="3">HSK 3</option>
                                    <option value="4">HSK 4</option>
                                    <option value="5">HSK 5</option>
                                    <option value="6">HSK 6</option>
                                    <option value="all" data-i18n="allLevels">All levels</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label for="quiz-questions" class="control-label" data-i18n="numberOfQuestions">Number
                                    of Questions</label>
                                <select id="quiz-questions" class="select-input">
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                </select>
                            </div>
                        </div>
                        <button id="start-quiz" class="btn btn-primary" data-i18n="startQuiz">Start</button>
                    </div>

                    <div class="quiz-container" id="quiz-container" style="display: none;">
                        <div class="quiz-header">
                            <div class="quiz-progress">
                                <span data-i18n="question">Question</span>
                                <span id="quiz-current">1</span>
                                <span data-i18n="of">of</span>
                                <span id="quiz-total">10</span>
                            </div>
                            <div class="quiz-score-display">
                                <span data-i18n="score">Score</span>:
                                <span id="quiz-score">0</span>
                            </div>
                        </div>
                        <div class="quiz-content" id="quiz-content">
                            <div class="question-text" id="quiz-question"></div>
                            <div class="quiz-options" id="quiz-options">
                                <!-- Quiz options will be populated here -->
                            </div>
                            <div class="quiz-actions">
                                <button id="quiz-submit" class="btn btn-primary" disabled
                                    data-i18n="submit">Submit</button>
                                <button id="quiz-next" class="btn btn-primary" style="display: none;"
                                    data-i18n="next">Next</button>
                            </div>
                        </div>
                    </div>

                    <div class="quiz-results" id="quiz-results" style="display: none;">
                        <h3 data-i18n="quizComplete">Quiz Complete!</h3>
                        <div class="results-summary" id="results-summary">
                            <div>
                                <span data-i18n="finalScore">Final Score</span>:
                                <strong id="final-score">0/0</strong>
                                (<span id="final-percentage">0%</span>)
                            </div>
                        </div>
                        <div class="results-actions">
                            <button id="restart-quiz" class="btn btn-primary" data-i18n="tryAgain">Retry</button>
                            <button id="new-quiz" class="btn btn-secondary" data-i18n="newQuiz">New Quiz</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Leaderboard Tab -->
            <div id="leaderboard" class="tab-panel">
                <div class="leaderboard-section">
                    <div class="leaderboard-header">
                        <h2 class="leaderboard-title" data-i18n="leaderboard">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px; vertical-align: -4px;">
                                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                                <path d="M4 22h16"></path>
                                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                            </svg>
                            Leaderboard
                        </h2>
                        <p class="leaderboard-subtitle" data-i18n="leaderboardSubtitle">Compete with other Chinese
                            learners</p>
                    </div>

                    <!-- Leaderboard Controls -->
                    <div class="leaderboard-controls">
                        <div class="control-group">
                            <label class="control-label" data-i18n="rankingType">Ranking Type:</label>
                            <select id="leaderboard-type" class="control-select">
                                <option value="total_studied" data-i18n="totalStudied">Total Studied</option>
                                <option value="accuracy" data-i18n="accuracy">Accuracy</option>
                                <option value="streak" data-i18n="bestStreak">Best Streak</option>
                                <option value="study_streak" data-i18n="studyStreak">Study Streak</option>
                                <option value="time_spent" data-i18n="timeSpent">Time Spent</option>
                                <option value="achievements" data-i18n="achievements">Achievements</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label class="control-label" data-i18n="timePeriod">Time Period:</label>
                            <select id="leaderboard-period" class="control-select">
                                <option value="all_time" data-i18n="allTime">All Time</option>
                                <option value="weekly" data-i18n="thisWeek">This Week</option>
                                <option value="monthly" data-i18n="thisMonth">This Month</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label class="control-label" data-i18n="hskLevelFilter">HSK Level:</label>
                            <select id="leaderboard-hsk-level" class="control-select">
                                <option value="all" data-i18n="allLevels">All Levels</option>
                                <option value="1">HSK 1</option>
                                <option value="2">HSK 2</option>
                                <option value="3">HSK 3</option>
                                <option value="4">HSK 4</option>
                                <option value="5">HSK 5</option>
                                <option value="6">HSK 6</option>
                            </select>
                        </div>

                        <button id="leaderboard-refresh" class="refresh-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 4 23 10 17 10"></polyline>
                                <polyline points="1 20 1 14 7 14"></polyline>
                                <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10"></path>
                                <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14"></path>
                            </svg>
                            <span data-i18n="refresh">Refresh</span>
                        </button>
                    </div>

                    <!-- User Position -->
                    <div id="user-position" class="user-position">
                        <!-- User position will be displayed here -->
                    </div>

                    <!-- Leaderboard Statistics -->
                    <div id="leaderboard-stats" class="leaderboard-stats">
                        <!-- Statistics will be displayed here -->
                    </div>

                    <!-- Loading Indicator -->
                    <div id="leaderboard-loader" class="leaderboard-loader">
                        <div class="loader-spinner"></div>
                        <p data-i18n="loadingLeaderboard">Loading leaderboard...</p>
                    </div>

                    <!-- Leaderboard Content -->
                    <div id="leaderboard-content" class="leaderboard-content">
                        <div id="leaderboard-list" class="leaderboard-list">
                            <!-- Leaderboard entries will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics Tab -->
            <div id="stats" class="tab-panel">
                <div class="stats-overview">
                    <h3 data-i18n="learningStatistics">Learning Statistics</h3>
                    <div class="stats-cards">
                        <div class="stat-card">
                            <div class="stat-value" id="total-studied">0</div>
                            <div class="stat-label" data-i18n="totalStudied">Total Studied</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="accuracy-rate">0%</div>
                            <div class="stat-label" data-i18n="accuracyRate">Accuracy Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="current-streak">0</div>
                            <div class="stat-label" data-i18n="currentStreak">Current Streak</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="quiz-count">0</div>
                            <div class="stat-label" data-i18n="quizzesCompleted">Quizzes Completed</div>
                        </div>
                    </div>

                    <div id="stats-empty-state" class="stats-empty-state" style="display: none;">
                        <div class="stats-empty-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20V10"></path><path d="m18 20-6-6-6 6"></path><path d="M12 4v2"></path></svg>
                        </div>
                        <h4 data-i18n="noStatsYet">No progress to show yet</h4>
                        <p data-i18n="startWithPracticeToSeeStats">Start with Practice to see your stats here</p>
                        <button class="btn btn-primary" onclick="window.app && window.app.switchTab('practice')" data-i18n="goToPractice">Go to Practice</button>
                    </div>
                </div>

                <div class="level-progress">
                    <h4 data-i18n="progressByLevel">Progress by HSK Level</h4>
                    <div id="level-progress-bars">
                        <!-- Progress bars will be populated here -->
                    </div>
                </div>

                <button id="reset-stats" class="btn btn-error" data-i18n="resetStats">Reset Statistics</button>
            </div>

            <!-- Matrix Game Tab -->
            <div id="matrix" class="tab-panel">
                <div id="matrix-game-container" class="matrix-game-container">
                    <!-- El contenido del juego se cargar√° din√°micamente aqu√≠ -->
                </div>
            </div>
    </div>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="dev-signature">
                <img src="assets/images/dev_logo.png" alt="Developer Logo" class="footer-logo">
                <div class="signature-text">
                    <p><span data-i18n="developedBy">Desarrollado con <span class="ascii-art">‚ô°</span> por</span>
                        <strong>Jose Alejandro Rollano Revollo</strong>
                    </p>
                    <p class="version" data-i18n="version">v3.0.1 | Advanced Chinese Learning Platform</p>
                </div>
            </div>
        </div>
    </footer>
    </div>

    <!-- Supabase CDN -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <!-- Supabase Configuration -->
    <script src="config/supabase-config.js?v=2"></script>
    <script src="assets/js/supabase-client.js?v=4"></script>

    <!-- Core Scripts -->
    <script src="assets/js/translations.js?v=14"></script>
    <script src="assets/js/supabase-progress-sync.js?v=6"></script>
    <script src="assets/js/progress-integrator.js?v=2"></script>
    <script src="assets/js/auth-backend.js?v=8"></script>
    <script src="assets/js/user-progress-backend.js?v=2"></script>
    <script>
        // Load diagnostic system only when requested via ?diagnostic=true
        if (window.location.search.includes('diagnostic=true')) {
            const script = document.createElement('script');
            script.src = 'assets/js/diagnostic-system.js?v=3';
            document.body.appendChild(script);
        }
    </script>
    <!-- Background Data (Base64 Fallback) -->
    <script src="assets/js/bg-data.js"></script>
    <script src="assets/js/app.js?v=24"></script>
    <script src="assets/js/matrix-game.js?v=6"></script>
    <script src="assets/js/matrix-game-ui.js?v=5"></script>
    <script src="assets/js/leaderboard.js?v=4"></script>

    <!-- Background Image Integration -->
    <!-- Background Image Integration (Removed hardcoded style) -->


    <script>
        console.log('[‚ñ∂] HSK App - Build: MAIN');
        console.log('[#] All scripts loaded');
        console.log('[Âç°] CSS enhancements applied');

        // Debug script execution
        setTimeout(function () {
            console.log('[?] Checking app status...');
            console.log('HSKApp exists:', typeof HSKApp !== 'undefined');
            console.log('window.app exists:', !!window.app);
            console.log('DOM ready state:', document.readyState);

            // Check if DOM elements exist
            console.log('nav-tab elements:', document.querySelectorAll('.nav-tab').length);
            console.log('next-btn exists:', !!document.getElementById('next-btn'));
            console.log('level-select exists:', !!document.getElementById('level-select'));

            // Force app initialization if needed
            if (typeof HSKApp !== 'undefined' && !window.app) {
                console.log('[‚öô] Force initializing app...');
                try {
                    window.app = new HSKApp();
                    console.log('[‚úì] App force initialized successfully');
                } catch (error) {
                    console.error('[‚úó] Error force initializing app:', error);
                }
            }
        }, 1000);

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const appBasePath = window.location.pathname.replace(/\/[^/]*$/, '/');
                    const swUrl = `${appBasePath}config/sw.js?v=3`;

                    const registration = await navigator.serviceWorker.register(swUrl, {
                        scope: appBasePath
                    });

                    if (registration.waiting) {
                        registration.waiting.postMessage({ type: 'SKIP_WAITING' });
                    }
                } catch (error) {
                    console.warn('Service Worker registration skipped:', error);
                }
            });
        }
    </script>
</body>

</html>